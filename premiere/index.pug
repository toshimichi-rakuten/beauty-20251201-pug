//- 旧クーポンLP専用テンプレート。毎回最新のものをフォルダごと複製して使用してください
//- Coupon Template (Old) / ver 3.0.0 / 更新日時：2024.5.30 / クーポン3個並列対応

extends ../../../../_common/pug/Base/_layout.pug

block init
  include _data
  - var css = `${'css/main.css' + parameter}`

block addHead
  //- nofollowが必要なときはコメントを外す
  //- meta(name='robots', content='noindex,nofollow')
  link(rel='stylesheet', href="css/splide.min.css")


block nav
  //- grobalNav / ''に入れた部分がcurrent表示になる
  +grobalNav('/cnt/topics/')

  //- breadcrumb
  -
    var lists = [
      {
        name: 'キャンペーン一覧・特集',
        link: 'https://beauty.rakuten.co.jp/cnt/topics/',
      },
      {
        name: meta.title, //- タイトル以外を設定したいときは変更
        link: 'current', //- 'current' is no link
      },
    ]
  +breadcrumb(lists)

block content
  #Premiere

    //- 終了対応
    //- #End
      - var endflag
      - var endTxt = 'このラ・クーポンは終了しました' //- ページ上部の文言
      - var btnTxt = 'ラ・クーポンは終了しました' //- ボタンの文言
      +endSet(endTxt)

    //- Campaign Tag
    //- Rule: https://confluence.rakuten-it.com/confluence/pages/viewpage.action?pageId=2688949406
    //- section#CpnTags
      +campaignTag(taglist)

    //- ID、class名は自由
    section#Main.main(data-ratid='cpn_' + meta.directory + '_Main' data-ratevent='appear' data-ratparam='all')
      //- Use h1
      h1.main__title
        img.main__titleImg.-pc(src='img/main.png' + parameter alt=meta.title)
        img.main__titleImg.-sp(src='img/main_sp.png' + parameter alt=meta.title)

    #Navigation.menu__nav(data-ratid='cpn_' + directory + '_Navigation' data-ratevent='appear' data-ratparam='all')
      ul.menu__nav__wrap
        li.menu__nav__list
          a.menu__nav__link(href='#PremiereIntro')
            | プルミエール
            br.-sp
            | の魅力
        li.menu__nav__list
          a.menu__nav__link(href='#PremiumStep')
            | 施術の
            br.-sp
            | 流れ
        li.menu__nav__list
          a.menu__nav__link(href='#Shoplist')
            | 取り扱い
            br.-sp
            | サロン

    section#PremiereIntro.premiere(data-ratid='cpn_' + directory + '_PremiereIntro' data-ratevent='appear' data-ratparam='all')
      h2.premiere--title
        | ケラスターゼメニューの中から
        br.-sp
        | 注目のトリートメントをご紹介！
      .premiere__main
        h3.premiere__main--title
          | 新ダメージケアシリーズ。
          br
          | 髪本来の姿*に導く、
          br
          | プレミアムボンディングダメージケア
        p.premiere__main--caption
          | *切れ毛を防ぎ、しなやかで滑らかな髪のこと
        .premiere__secondary__feature
          img.-pc(src='img/img_premiere_intro.png' + parameter alt='プルミエール サロン限定 プレミアム４ステップ４ステップダメージケア' width='100%')
          img.-sp(src='img/img_premiere_intro_sp.png' + parameter alt='プルミエール サロン限定 プレミアム４ステップ４ステップダメージケア' width='100%')

    section#PremiereImage.premiere__secondary(data-ratid='cpn_' + directory + '_PremiereImage' data-ratevent='appear' data-ratparam='all')
      .premiere__secondary--title
        | 仕上がりイメージ
      p.premiere__secondary--title--info
        | *ケラスターゼ調べ。仕上がりには個人差があります。

      //- PC用 仕上がりイメージ
      .premiere__finish__container.-pc
        ul.premiere__finish
          li.premiere__finish__img
            img(src='img/img_finish1.jpg' + parameter alt='仕上がりイメージ1' width='100%')
          li.premiere__finish__img
            img(src='img/img_finish2.jpg' + parameter alt='仕上がりイメージ2' width='100%')
          li.premiere__finish__img
            img(src='img/img_finish3.jpg' + parameter alt='仕上がりイメージ3' width='100%')
          li.premiere__finish__img
            img(src='img/img_finish4.jpg' + parameter alt='仕上がりイメージ4' width='100%')

      //- SP用 仕上がりイメージ
      .premiere__finish__container.-sp
        ul.premiere__finish
          li.premiere__finish__img
            img(src='img/img_finish1.jpg' + parameter alt='仕上がりイメージ1' width='100%')
          li.premiere__finish__img
            img(src='img/img_finish2.jpg' + parameter alt='仕上がりイメージ2' width='100%')
          li.premiere__finish__img
            img(src='img/img_finish3.jpg' + parameter alt='仕上がりイメージ3' width='100%')
          li.premiere__finish__img
            img(src='img/img_finish4.jpg' + parameter alt='仕上がりイメージ4' width='100%')
        ul.premiere__finish
          li.premiere__finish__img
            img(src='img/img_finish1.jpg' + parameter alt='仕上がりイメージ1' width='100%')
          li.premiere__finish__img
            img(src='img/img_finish2.jpg' + parameter alt='仕上がりイメージ2' width='100%')
          li.premiere__finish__img
            img(src='img/img_finish3.jpg' + parameter alt='仕上がりイメージ3' width='100%')
          li.premiere__finish__img
            img(src='img/img_finish4.jpg' + parameter alt='仕上がりイメージ4' width='100%')
        ul.premiere__finish
          li.premiere__finish__img
            img(src='img/img_finish1.jpg' + parameter alt='仕上がりイメージ1' width='100%')
          li.premiere__finish__img
            img(src='img/img_finish2.jpg' + parameter alt='仕上がりイメージ2' width='100%')
          li.premiere__finish__img
            img(src='img/img_finish3.jpg' + parameter alt='仕上がりイメージ3' width='100%')
          li.premiere__finish__img
            img(src='img/img_finish4.jpg' + parameter alt='仕上がりイメージ4' width='100%')
      .premiere__recommend__target
        .premiere__recommend__target__img
          img.-pc(src='img/img_recommend_target.png' + parameter alt='こんな方におすすめ' width='100%')
          img.-sp(src='img/img_recommend_target_sp.png' + parameter alt='こんな方におすすめ' width='100%')
      .premiere__recommend__check__container
        //- PC用
        .premiere__recommend__check.-pc
          .premiere__recommend__check__img
            img.-pc(src='img/img_recommend_check.png' + parameter alt='補修成分 カルシウムがたまっている' width='100%')
          .premiere__recommend__check__caption
            p.premiere__recommend__check__caption--title
              | 知っていましたか・・・？
            p.premiere__recommend__check__caption--text
              | 傷んだ髪は、髪内部がダメージを受けているだけでなく、
              br
              | 水の中に含まれるカルシウムを過剰に
              br
              | 吸収しやすくなっています。
              br
              | カルシウムは、切れ毛や髪のザラつきを誘発して、
              br
              | 補修がしづらい髪の状態にしてしまうことも。
            p.premiere__recommend__check__caption--text
              | 実は、
              span.premiere__recommend__check__caption--text-bold
                | 水の中に含まれるカルシウムが髪のダメージを加速
              br
              | させています。
            p.premiere__recommend__check__caption--text
              span.premiere__recommend__check__caption--text-bold
                | 美髪をキープするには髪内部の補修に加えて、
                br
                span.premiere__recommend__check__caption--text-emphasis
                  | 髪に付着したカルシウムを除去すること
                br
                | が大切です。
        //- SP用
        div.-sp
          p.premiere__recommend__check__caption--title
            | 知っていましたか・・・？
          .premiere__recommend__check.-sp
            .premiere__recommend__check__img
              img.-sp(src='img/img_recommend_check.png' + parameter alt='補修成分 カルシウムがたまっている' width='100%')
            p.premiere__recommend__check__caption
              | 傷んだ髪は、髪内部がダメージを受けているだけでなく、水の中に含まれるカルシウムを過剰に吸収しやすくなっています。
              br
              | カルシウムは、切れ毛や髪のザラつきを誘発して、補修がしづらい髪の状態にしてしまうことも。
          p.premiere__recommend__check__caption--text
            | 実は、
            span.premiere__recommend__check__caption--text-bold
              | 水の中に含まれるカルシウムが
              br
              | 髪のダメージを加速
            | させています。
          p.premiere__recommend__check__caption--text
            span.premiere__recommend__check__caption--text-bold
              | 美髪をキープするには髪内部の補修に加えて、
              br
              span.premiere__recommend__check__caption--text-emphasis
                | 髪に付着したカルシウムを除去すること
              br
              | が大切です。
      .premiere__recommend__technology__container
        .premiere__recommend__technology__wrap
          p.premiere__recommend__technology--title
            | 日本の研究所が開発
            br.-sp
            | 『ペア補修テクノロジー』
          p.premiere__recommend__technology--lead
            | 10年の研究の上に編み出された、
            br
            | 髪本来の姿に導くためのダメージケア。
          p.premiere__recommend__technology--info
            | *切れ毛を防ぎ、しなやかで滑らかな髪のこと
          .premiere__recommend__technology__img
            img(src='img/img_recommend_technology.png' + parameter alt='DECALCIFY1 カルシウム除去 DECALCIFY2 髪の内部補修' width='100%')
          p.premiere__recommend__technology--lead
            | カルシウム除去と髪の内部補修を両方叶えるクエン酸*
            br.-sp
            | とグリシン*の濃縮酸のバランスを発見。
          p.premiere__recommend__technology--lead
            | ダメージケアでありながら、髪本来のしなやかさと
            br.-sp
            | なめらかさのある、さらさらとした髪へ導きます。
          p.premiere__recommend__technology--info
            | *毛髪補修成分

    section#PremiumStep.premiere__secondary(data-ratid='cpn_' + directory + '_PremiumStep' data-ratevent='appear' data-ratparam='all')
      .premiere__secondary--title
        | プレミアム4ステップダメージケア 施術の流れ
      .premiumstep__container
        .premiumstep__img
          img(src='img/img_premiumstep.jpg' + parameter alt='サロン専用製品を用いた、贅沢な2回の重ね付けで、ダメージヘアに寄り添います。' width='100%')
        .premiumstep--caption
          | サロン専用製品を用いた、贅沢な2回の重ね
          br.-sp
          | 付けで、ダメージヘアに寄り添います。

        //- PC用 メニュー
        ul.premiumstep__step.-pc
          li.premiumstep__step__list
            img(src='img/img_treatment_step1.png' + parameter alt='step1 プレトリートメント' width='100%')
          li.premiumstep__step__list
            img(src='img/img_treatment_step2.png' + parameter alt='step2 シャンプー' width='100%')
          li.premiumstep__step__list
            img(src='img/img_treatment_step3.png' + parameter alt='step3 サロン専用液状トリートメント' width='100%')
          li.premiumstep__step__list
            img(src='img/img_treatment_step4.png' + parameter alt='step4 ヘアマスク' width='100%')

        //-  SP用 メニュー スライダー
        .splide.-sp
          .splide__track
            ul.splide__list.premiumstep__step.-sp
              li.splide__slide.premiumstep__step__list
                img.premiumstep__step__list__img(src='img/img_treatment_step1.png' + parameter alt='step1 プレトリートメント' width='100%')
              li.splide__slide.premiumstep__step__list
                img.premiumstep__step__list__img(src='img/img_treatment_step2.png' + parameter alt='step2 シャンプー' width='100%')
              li.splide__slide.premiumstep__step__list
                img.premiumstep__step__list__img(src='img/img_treatment_step3.png' + parameter alt='step3 サロン専用液状トリートメント' width='100%')
              li.splide__slide.premiumstep__step__list
                img.premiumstep__step__list__img(src='img/img_treatment_step4.png' + parameter alt='step4 ヘアマスク' width='100%')
        p.premiumstep__step--info
          | ※ステップはメニューによって異なる場合があります。

    section#Fragrance.premiere__secondary(data-ratid='cpn_' + directory + '_Fragrance' data-ratevent='appear' data-ratparam='all')
      .premiere__secondary--title
        | FRAGRANCE
      .fragrance__container
        p.fragrance--caption
          | 生き生きとしたマンダリンオレンジのみずみずしさを表現。
          br
          | オレンジフラワーとジャスミンのアコードに包まれたシトラス
          br.-sp
          | とマンダリンのカクテルがあなたをイタリアへと誘います。
        .fragrance__img
          img(src='img/img_fragrance.png' + parameter alt='TOP マンダリンシトラス MIDDLE やわらかく繊細な花 BASE 包み込むウッディの香り' width='100%')

    //- anchor link
    #Shoplist(data-ratid='cpn_' + meta.directory + '_Shoplist' data-ratevent='appear' data-ratparam='all')

    //- shoplist
    section#salonFilterContainer
      #salonFilterSection(ref="wrapper", class="is-loading")
        .loader

        //- mixin card
        mixin card()
          if shoplist.select == '1column' || shoplist.select == 'btn'
            - var type = 'filterList'
          else if shoplist.select == '2column'
            - var type = 'filteredSalonList'
          #salonList(ref="list")
            .salonList
              section(v-for="item, index in " + type, :key="index", class="salonList__item position-relative")
                .salonList__content
                  .salonList__cover
                    img(:src='"//cloudinary-a.akamaihd.net/vivivi/image/upload/t_beauty,f_auto,dpr_2.0,q_auto:good/c_fill,g_auto,w_370,h_229/" + item.shop_id + "_01.jpg" + param', class="salonList__image", rel="preload", :alt="item.shop_name")
                  .salonList__outline
                    h3.salonList__salonName
                      a(:href='"/" + item.shop_id + "/?" + lid', class="salonList__link stretched-link") {{ item.shop_name }}
                    span.salonList__area
                      i.icon.icon-location
                      | {{ item.area }}
                    span.salonList__station
                      i.icon.icon-train
                      | {{ item.station }}
        //- mixin menuCard
        mixin menuCard()
          #salonList(ref="list")
            if shoplist.select == '1column' || shoplist.select == 'btn'
              - var type = 'filterList'
            else if shoplist.select == '2column'
              - var type = 'filteredSalonList'
            .salonList
              section(v-for="item, index in " + type, :key="index", class="salonList__item has-divide")
                .salonList__content.position-relative
                  .salonList__cover
                    img(:src='"//cloudinary-a.akamaihd.net/vivivi/image/upload/t_beauty,f_auto,dpr_2.0,q_auto:good/c_fill,g_auto,w_370,h_229/" + item.shop_id + "_01.jpg" + param', class="salonList__image", rel="preload", :alt="item.shop_name")
                  .salonList__outline
                    h3.salonList__salonName
                      a(:href='"/" + item.shop_id + "/?" + lid', class="salonList__link stretched-link") {{ item.shop_name }}
                    span.salonList__area
                      i.icon.icon-location
                      | {{ item.area }}
                    span.salonList__station
                      i.icon.icon-train
                      | {{ item.station }}
                .salonList__divide.position-relative
                  .salonList__outline
                    .salonList__detail
                      .salonList__menuIcon
                        span.salonList__genre.-no1(v-if='item.genreNo_1 == 1') {{ item.genre_1 }}
                        span.salonList__genre.-no2(v-if='item.genreNo_1 == 2') {{ item.genre_1 }}
                        span.salonList__genre.-no3(v-if='item.genreNo_1 == 3') {{ item.genre_1 }}
                      .salonList__menuDetail
                        h4.salonList__menuName
                          span.salonList__target(v-if='item.target_1 == "初回"') {{ item.target_1 }}
                          span.salonList__target.is-all(v-if='item.target_1 == "全員"') {{ item.target_1 }}
                          | {{ item.menu_name_1 }}
                    p.salonList__description {{ item.menu_detail_1 }}
                  .salonList__buttonArea
                    .salonList__menuPriceArea
                      span.salonList__menuTime 約{{ item.menu_time_1 }}分
                      span.salonList__menuPrice ￥{{ item.menu_price_1.toLocaleString() }}
                    .salonList__menuTermsArea
                      span.salonList__menuTerm {{ item.condition_1 }}
                    a(:href='"/reserve/?shop_ex_id=" + item.shop_id + "&menu_id=" + item.menu_id_1 + "&" + lid', class="stretched-link salonList__button") このメニューで予約する
                .salonList__divide.position-relative(v-if='item.menu_id_2')
                  .salonList__outline
                    .salonList__detail
                      .salonList__menuIcon
                        span.salonList__genre.-no1(v-if='item.genreNo_2 == 1') {{ item.genre_2 }}
                        span.salonList__genre.-no2(v-if='item.genreNo_2 == 2') {{ item.genre_2 }}
                        span.salonList__genre.-no3(v-if='item.genreNo_2 == 3') {{ item.genre_2 }}
                      .salonList__menuDetail
                        h4.salonList__menuName
                          span.salonList__target(v-if='item.target_2 == "初回"') {{ item.target_2 }}
                          span.salonList__target.is-all(v-if='item.target_2 == "全員"') {{ item.target_2 }}
                          | {{ item.menu_name_2 }}
                    p.salonList__description {{ item.menu_detail_2 }}
                  .salonList__buttonArea
                    .salonList__menuPriceArea
                      span.salonList__menuTime 約{{ item.menu_time_2 }}分
                      span.salonList__menuPrice ￥{{ item.menu_price_2.toLocaleString() }}
                    .salonList__menuTermsArea
                      span.salonList__menuTerm {{ item.condition_2 }}
                    a(:href='"/reserve/?shop_ex_id=" + item.shop_id + "&menu_id=" + item.menu_id_2 + "&" + lid', class="stretched-link salonList__button") このメニューで予約する

        //- 1column
        if shoplist.select == '1column'
          #salonFilter
            h2.filter-heading !{shoplist.title[0]}
              if shoplist.title[1]
                span.-sp
                  br
                | !{shoplist.title[1]}
            .filter-select
              select.filter-select__item(v-model="select1")
                option(value="") !{shoplist.firstTxt1}
                option(v-for="(item, index) in select1List", :value="item.name") {{ item.name }} ({{ item.count }}件)
          if shoplist.menu == false
            +card()
          else if shoplist.menu == true
            +menuCard()

        //- 2column
        else if shoplist.select == '2column'
          #salonFilter
            h2.filter-heading !{shoplist.title[0]}
              if shoplist.title[1]
                span.-sp
                  br
                | !{shoplist.title[1]}
            .filter-select
              select.filter-select__item(v-model="select1", ref="select1")
                option(value="", selected) !{shoplist.firstTxt1}
                option(v-for="(item, index) in select1List", :value="item") {{ item }}
            .filter-select
              select.filter-select__item(v-model="select2", ref="select2", disabled)
                option(value="", selected) !{shoplist.firstTxt2}
                option(v-for="(item, index) in select2List", :value="item") {{ item }}
            button(class="filter-button", disabled, v-on:click="search", ref="button")
              span 検索
              span(v-if="count !== 0 && !firstFlag") （{{count}}件）
          if shoplist.menu == false
            +card()
          else if shoplist.menu == true
            +menuCard()

        //- btn
        else if shoplist.select == 'btn'
          #salonFilter
            h2.filter-heading !{shoplist.title[0]}
              if shoplist.title[1]
                span.-sp
                  br
                | !{shoplist.title[1]}
            ul.filter-button-list
              li.filter-button-list-item
                button.filter-list-button(@click="select1 = ''", :class="{'is-selected': select1 == ''}") すべて
              li.filter-button-list-item(v-for="(item, index) in select1List")
                button.filter-list-button(@click="select1 = item.name", :class="{'is-selected': select1 == item.name}") {{ item.name }} ({{ item.count }}件)
          if shoplist.menu == false
            +card()
          else if shoplist.menu == true
            +menuCard()


block js
  //- jsはここに書く

  //------------------------------- ライブラリ読み込み -------------------------------//

  //- jQuery（使用しない時はコメントアウト）
  //- script(src="/cnt/common/js/jquery/3.7.1/jquery.min.js", defer)

  //- vue（使用しない時はコメントアウト）
  script(src='/cnt/common/js/vue/vue.min.js', defer)
  script(src='/cnt/common/js/vue/axios.min.js', defer)

  //------------------------------- CPNパーツ用js読み込み -------------------------------//

  //- ボタン+checkbox（vue）
  //- script(src="/cnt/common/js/cpn-parts/btn_checkbox.js", defer)

  //- 1click coupon
  //- script(src='//r.r10s.jp/com/js/d/Rmodules/Rmodules.min.js?v=1.4.0', defer)
  //- script(src='//r.r10s.jp/com/js/d/coupon/one_click_acquisition/1.2/one_click_acquisition-1.2.0.min.js', defer)

  //------------------------------- Shoplist 絞り込み (vue) -------------------------------//

  //- js用パラメータ生成
  script.
    const param = '!{parameter}';
    const lid = '!{shoplist.lid}';
    const firstSelect1 = '!{shoplist.firstSelect1}';
    const firstSelect2 = '!{shoplist.firstSelect2}';

  //- pugで読み込みjsのurl（パラメータつき）を生成 = キャッシュ対策
  -
    var jsUrl1column = `${'js/filter-by-1column.js' + parameter}`
    var jsUrl2column = `${'js/filter-by-2column.js' + parameter}`

  //- json読み込み & 絞り込み (vue)
  if shoplist.select == '1column' || shoplist.select == 'btn'
    script(src=jsUrl1column, defer)
  else if shoplist.select == '2column'
    script(src=jsUrl2column, defer)

  //------------------------------- このページ用のjs -------------------------------//

  //- あればここに書く
  //- splide
  script(src="js/splide.min.js", defer)
  script.
    document.addEventListener( 'DOMContentLoaded', function() {
      var elms = document.getElementsByClassName( 'splide' );
      for ( var i = 0; i < elms.length; i++ ) {
        new Splide( elms[ i ] ).mount();
      }
    } );


